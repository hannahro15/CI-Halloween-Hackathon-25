{% extends 'base.html' %}
{% load static %}

{% block title %}{{ user.username }}'s Profile{% endblock %}

{% block extra_head %}
<link rel="stylesheet" href="{% static 'css/index.css' %}">
<link rel="stylesheet" href="{% static 'css/cardstyle.css' %}">
<link rel="stylesheet" href="{% static 'css/profile.css' %}">
{% endblock %}

{% block content %}
<main class="container-fluid p-0 halloween-home">
    <section class="container text-center py-5 text-light">
        <h1 class="display-3 spooky-text mb-3">{{ profile.user.username }}'s  Spooky Sanctuary</h1>

                <div class="profile-matches-container">
            <div class="profile-card-grid" id="profileCats"></div>

            {% if not adopted_cats %}
                <div class="empty-state">
                    <div class="empty-state-icon">ðŸ˜¿</div>
                    <h3 class="empty-state-title">No Adopted Cats Yet!</h3>

                </div>
            {% endif %}
        </div>
    </section>
</main>
{% endblock %}


{% block extra_scripts %}
<script>
    const cats = JSON.parse('{{ adopted_cats_json|safe }}');
    const container = document.getElementById("profileCats");


    // Same card colors as cardscript.js
    const cardColors = [
        "#ac85b2",
        "#ff6f40",
        "#a7ac21",
        "#fc9a99",
        "#fdbe70",
        "#ff7f00",
        "#cab2d6",
    ];

    // Reused same buildCard function from cardscript.js
    function buildCard(cat) {
        const card = document.createElement('div');
        card.className = 'swipe-card';

        const cardColourNum = cat.id % cardColors.length;
        card.style.backgroundColor = cardColors[cardColourNum];

        const content = document.createElement('div');
        content.className = 'card-content';

        // Image
        const img = document.createElement('img');
        if (cat.image_url) {
            img.src = cat.image_url;
        } else {
            img.src = "{% static 'images/placeholder.png' %}";
        }
        img.alt = cat.name;
        img.className = 'card-image';
        content.appendChild(img);

        // Cat Title
        const h3 = document.createElement('h3');
        h3.className = 'card-title m-0 p-0';
        h3.textContent = cat.name;
        content.appendChild(h3);

        // Cat Speciality
        const pSpecial = document.createElement('p');
        pSpecial.className = 'card-speciality m-0 p-0';
        pSpecial.textContent = cat.speciality || '';
        content.appendChild(pSpecial);

        // Cat Biography
        const pBio = document.createElement('p');
        pBio.className = 'card-bio m-0 p-0';
        pBio.textContent = cat.biography || '';
        content.appendChild(pBio);

        card.setAttribute("data-cat-id", cat.id);
        card.appendChild(content);
        return card;
    }

    // Build and display all cards
    if (cats.length > 0) {
        cats.forEach(cat => {
            const card = buildCard(cat);
            container.appendChild(card);
        });
    }
</script>
{% endblock %}
